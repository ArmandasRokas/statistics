####################### 1 ####################### 
# Method 1.15

####################### 2 ####################### 
prop.test(62+113+37,255+433+153, correct=FALSE)

####################### 3 ####################### 

prop.test(c(62,37),c(255, 153), correct=FALSE)


####################### 4 ####################### 

expected <- 76*129/1268
contribution <- (10-expected)^2/expected
contribution


####################### 5 ####################### 
chiobs <- 29
nrow <- 5
ncol <- 4
p_value <- 1-pchisq(abs(chiobs), df=(nrow-1)*(ncol-1))
p_value

####################### 6 ####################### 
p <- 0.04
ME <- 0.01
n <- p*(1-p)*(qnorm(1-0.05/2)/ME)^2
n
####################### 7 ####################### 

# p-values are 0.481 and 0.165

####################### 8 ####################### 

####################### 9 ####################### 

0.3481/(7.083*10^-3 )


####################### 10 ####################### 

qt(1-0.05/2, df=46)

####################### 11 ####################### 
# Theorem 2.47
# First insert 2015 and than substract results with results by inserting 2010
####################### 12 ####################### 

####################### 13 ####################### 
x <- rnorm(100000)^2 + rnorm(100000)^2 + rnorm(100000)^2
hist(x)
c <- rchisq(100000,df=3)
hist(c)

####################### 14 ####################### 
replicate(10, rexp(1, 2))


####################### 15  ####################### 



####################### 16  ####################### 

####################### 17  ####################### 
x <- 3 # Number of successes to be obtained
a <- 3 # Total number of successes in the population
N <- 20 # Size of the population
n <- 10 # Number of draws

dhyper(x=x,m=a,n=N-a,k=n)

####################### 18 ####################### 
mu <- exp(1+(0.7^2/2))
mu
####################### 19 ####################### 
prob_one <- 1-plnorm(10,1, 0.7)
1 - pbinom(2,20,prob_one)

####################### 21 ####################### 

####################### 22 ####################### 

####################### 23 ####################### 
# Insert
x_bar <- 10.84
sd <- 272.322
alpha <- 0.05
n <-1310


# Calculate
qt <- qt(1-alpha/2, df=n-1)
res <- qt*(sd/sqrt(n))
c(x_bar-res, x_bar+res)


#######################  24 ####################### 

# df=89, so n = 89+1, because 1 degree of freedom

####################### 25 ####################### 

# Paired, because data colletec for the same power system.

####################### 26 ####################### 
fobs <- qf(1- 0.05, df1=6,df2=357)
fobs
####################### 27 ####################### 
# It is MSE
####################### 28 ####################### 
4934/(140016+4934)
####################### 29 ####################### 
x <- c(1.11, 0.94, -2.43, -0.90,
       0.29, -1.41,
       0.38,
       0.99, -0.50)
median(x, type=2)
####################### 30 ####################### 
# CLT , where degree of freedom is n-1 