beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
y
# Example 5.7
n <- 10; k <- 3
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
y
# Example 5.7
n <- 10; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
# Example 5.7
n <- 1000; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
# Example 5.7
n <- 1000; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
# Example 5.7
n <- 1000; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 1000; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 1000; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 1000; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 1000; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 1000; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 5; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 5; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 1; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 1; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 2; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 2; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
n <- 100000; k <- 1000
beta0 <- 10; beta1 <- 3; sigma <- 5
x <- seq(-2, 5, length=n)
y <- matrix(0, ncol=k, nrow=n)
y <- y + beta0 + beta1*x + rnorm(n*k, sd=sigma)
b0 <- numeric(k); b1 <- numeric(k)
for(i in 1:k){
b <- coef(lm(y[ ,i] ~ x))
b0[i] <- b[1]
b1[i] <- b[2]
}
c(mean(b0), mean(b1))
beta0 <- coef(fitStudents)[1]
coef(fitStudents)
beta0 <- coef(fitStudents)[1]
beta1 <- coef(fitStudents)[2]
e <- y - (beta0 + beta1 * x)
n <- length(e)
sigma <- sqrt(sum(e^2) / (n - 2))
sigma.beta0 <- sqrt(sigma^2 * (1 / n + xbar^2 / Sxx))
sigma.beta1 <- sqrt(sigma^2 / Sxx)
c(sigma, sigma.beta0, sigma.beta1)
e <- y - (beta0 + beta1 * x)
e
x <- c(168, 161, 167, 179, 184, 166, 198, 187, 191, 179)
y <- c(65.5, 58.3, 68.1, 85.7, 80.5, 63.4, 102.6, 91.4, 86.7, 78.9)
D <- data.frame("Height"=x, "Weight"=y)
fitStudents <- lm(weight ~ height, data=D)
summary(fitStudents)
coef(fitStudents)
beta0 <- coef(fitStudents)[1]
beta0 <- coef(fitStudents)[1]
beta1 <- coef(fitStudents)[2]
e <- y - (beta0 + beta1 * x)
n <- length(e)
e
?predict
D <- data.frame(
pressure=c(1.02,2.08,2.89,4.01,5.32,5.83,7.26,7.96,9.11,9.99),
flux=c(1.15,0.85,1.56,1.72,4.32,5.07,5.00,5.31,6.17,7.04)
)
D
fit <- lm(flux ~ pressure, data=D)
out <- summary(fit)
D <- data.frame(
pressure=c(1.02,2.08,2.89,4.01,5.32,5.83,7.26,7.96,9.11,9.99),
flux=c(1.15,0.85,1.56,1.72,4.32,5.07,5.00,5.31,6.17,7.04)
)
fit <- lm(flux ~ pressure, data=D)
out <- summary(fit)
out$r.squared
sqrt(out$r.squared)
cor(x, y, data=D)^2
cor(D$pressure, D$flux)^2
cor(D$pressure, D$flux)
# 5.6 b)
alpha <- 0.1
beta1hat <- coef(fit)[2]
sigmabeta1 <- out$coefficients[2, 2]
c( beta1hat - qt((1-alpha/2), df=length(x)-2)*sigmabeta1,
beta1hat + qt((1-alpha/2), df=length(x)-2)*sigmabeta1
)
c( beta1hat - qt((1-alpha/2), df=out$df)*sigmabeta1,
beta1hat + qt((1-alpha/2), df=length(x)-2)*sigmabeta1
)
out$df
D
out$df[2]
c( beta1hat - qt((1-alpha/2), df=out$df[2])*sigmabeta1,
beta1hat + qt((1-alpha/2), df=out$df[2])*sigmabeta1
)
0.7225-1.860
0.7225-1.860*Â· 0.0706
0.7225-1.860* 0.0706
out
c( beta1hat - qt((1-alpha/2), df=out$df[2])*sigmabeta1,
beta1hat + qt((1-alpha/2), df=out$df[2])*sigmabeta1
)
# 5.6 c)
varNotExplained <- sum((D$flux-mean(D$flux))^2)
varNotExplained
varNotExplained <-sum(D$flux - (beta0hat + beta1hat*D$pressure)) /  sum((D$flux-mean(D$flux))^2)
# 5.6 c)
beta0hat <- coef(fit)[1]
beta1hat <- coef(fit)[2]
varNotExplained <-sum(D$flux - (beta0hat + beta1hat*D$pressure)) /  sum((D$flux-mean(D$flux))^2)
varNotExplained
varNotExplained <-sum((D$flux - (beta0hat + beta1hat*D$pressure)^2) /  sum((D$flux-mean(D$flux))^2)
varNotExplained
varNotExplained <-sum((D$flux - (beta0hat + beta1hat*D$pressure)^2)) /  sum((D$flux-mean(D$flux))^2)
varNotExplained
varNotExplained <-sum((D$flux - (beta0hat + beta1hat*D$pressure))^2) /  sum((D$flux-mean(D$flux))^2)
varNotExplained
1 - cor(D$pressure, D$flux)
1 - cor(D$pressure, D$flux)^2
out
out
out$coefficients[2,4]
out$coefficients[1,4]
# 5.6 d)
pvalue0 <- out$coefficients[1,4]
pvalue0
xnews <- c(3.5,5.0, 9.5)
predict(fit, newdata=data.frame(distances=xnews), interval="confidence", level=1-alpha)
predict(fit, newdata=data.frame(distances=3.5), interval="confidence", level=1-alpha)
predict(fit, newdata=data.frame(pressure=3.5), interval="confidence", level=1-alpha)
predict(fit, newdata=data.frame(pressure=xnews), interval="confidence", level=1-alpha)
res <- predict(fit, newdata=data.frame(pressure=xnews), interval="confidence", level=1-alpha)
CIs <- predict(fit, newdata=data.frame(pressure=xnews), interval="confidence", level=1-alpha)
CIs[1,1]
bla <- 1
bla <- c(1)
ba[1] <- 1
bla[1] <- 1
bla <- c()
bla[1] <- 1
constans <- numeric(3)
constants <- numeric(3)
CIs[1,2]
constants[i] <- CIs[i,3]-CIs[i,1]
for (i in 1:3){
constants[i] <- CIs[i,3]-CIs[i,1]
}
constans
CIs <- predict(fit, newdata=data.frame(pressure=xnews), interval="confidence", level=1-alpha)
constants <- numeric(3)
for (i in 1:3){
constants[i] <- CIs[i,3]-CIs[i,1]
}
constans
constants
?Air
data("air")
data(air)
n <- 100
rnorm(n)
?plot
plot(1,1)
plot(2,1)
plot(3,1)
n <- 100
x1 <- runif(n)
x2 <- runif(n)
cor(x1,x2)
y <- x1 + 2*x2^2 + rnorm(n,sd=0.125)
y <- x1 + 2*x2^2 + rnorm(1,sd=0.125)
n
plot(x1, y, pch=19, cex=0.5)
plot(x2, y, pch=19, cex=0.5)
beta + qt((1-alpha/2), df=237)*sigmabeta
alpha <- 0.05
beta <- -2.36500
sigmabeta <- 0.22184
beta + qt((1-alpha/2), df=237)*sigmabeta
c(
beta - qt((1-alpha/2), df=237)*sigmabeta,
beta + qt((1-alpha/2), df=237)*sigmabeta )
qt((1-alpha/2)
qt((1-alpha/2), df=237)
qt((1-alpha/2), df=237)
c(
beta - qt((1-alpha/2), df=237)*sigmabeta,
beta + qt((1-alpha/2), df=237)*sigmabeta )
alpha <- 0.05
beta <- 0.47621
sigmabeta <- 0.06169
c(
beta - qt((1-alpha/2), df=237)*sigmabeta,
beta + qt((1-alpha/2), df=237)*sigmabeta )
0.47621 + 1.97*0.062
0.47621 + 1.97*0.06169
alpha <- 0.05
beta <- 0.08269
sigmabeta <- 0.06977
c(
beta - qt((1-alpha/2), df=237)*sigmabeta,
beta + qt((1-alpha/2), df=237)*sigmabeta )
0.083 + 1.97 * 0.070
# 6.2
D <- data.frame(
x1=c(0.58, 0.86, 0.29, 0.20, 0.56, 0.28, 0.08, 0.41, 0.22, 0.35,
0.59, 0.22, 0.26, 0.12, 0.65, 0.70, 0.30, 0.70, 0.39, 0.72,
0.45, 0.81, 0.04, 0.20, 0.95),
x2=c(0.71, 0.13, 0.79, 0.20, 0.56, 0.92, 0.01, 0.60, 0.70, 0.73,
0.13, 0.96, 0.27, 0.21, 0.88, 0.30, 0.15, 0.09, 0.17, 0.25,
0.30, 0.32, 0.82, 0.98, 0.00),
y=c(1.45, 1.93, 0.81, 0.61, 1.55, 0.95, 0.45, 1.14, 0.74, 0.98,
1.41, 0.81, 0.89, 0.68, 1.39, 1.53, 0.91, 1.49, 1.38, 1.73,
1.11, 1.68, 0.66, 0.69, 1.98)
)
?summary
fit <-lm(y ~ x1 + x2, data = D)
summary(fit)
confint(fit, level=0.95)
# 6.2 b)
fit <- lm(y ~ x1, data =D)
summary(fit)
# 6.2 c)
qqnorm(fit$residuals)
qqline(fit$residuals)
## Walley
qqwrap <- function(x, y, ...){
stdy <- (y-mean(y))/sd(y)
qqnorm(stdy, main="", ...)
qqline(stdy)}
wallyplot(x-mean(fit$residuals), FUN=qqwrap, ylim=c(-3,3))
## Walley
qqwrap <- function(x, y, ...){
stdy <- (y-mean(y))/sd(y)
qqnorm(stdy, main="", ...)
qqline(stdy)}
stdy <- (y-mean(y))/sd(y)
qqnorm(stdy, main="", ...)
qqline(stdy)}
wallyplot(x-mean(fit$residuals), FUN=qqwrap, ylim=c(-3,3))
library(prodlim)
library(MESS)
## Walley
qqwrap <- function(x, y, ...){
stdy <- (y-mean(y))/sd(y)
qqnorm(stdy, main="", ...)
qqline(stdy)}
wallyplot(x-mean(fit$residuals), FUN=qqwrap, ylim=c(-3,3))
wallyplot(fit$residuals, FUN=qqwrap, ylim=c(-3,3))
qqnorm(stdy, main="", ...)
## Walley
qqwrap <- function(x, y, ...){
stdy <- (y-mean(y))/sd(y)
qqnorm(stdy, main="", ...)
qqline(stdy)}
wallyplot(fit$residuals, FUN=qqwrap, ylim=c(-3,3))
## Walley
qqwrap <- function(x, y, ...){
stdy <- (y-mean(y))/sd(y)
qqnorm(stdy, main="", ...)
qqline(stdy)}
wallyplot(fit$residuals, FUN=qqwrap, ylim=c(-3,3))
qqnorm(fit$residuals)
qqline(fit$residuals)
plot(fit$fitted.values, fit$residuals)
# 6.2 c)
par(mfrow=c(1,2))
qqnorm(fit$residuals)
qqline(fit$residuals)
plot(fit$fitted.values, fit$residuals)
plot(fit$fitted.values, fit$residuals, title="Fitted values vs residuals")
# 6.2 c)
par(mfrow=c(1,2))
qqnorm(fit$residuals)
qqline(fit$residuals)
plot(fit$fitted.values, fit$residuals, title="Fitted values vs residuals")
plot(fit$fitted.values, fit$residuals, main="Fitted values vs residuals")
# 6.2 c)
par(mfrow=c(1,2))
qqnorm(fit$residuals)
qqline(fit$residuals)
plot(fit$fitted.values, fit$residuals, main="Fitted values vs residuals")
# 6.2 c)
par(mfrow=c(1,2))
qqnorm(fit$residuals)
qqline(fit$residuals)
plot(fit$fitted.values, fit$residuals, main="Fitted vs residuals")
x1new <- seq(0,1,by=0.01)
pred <- predict(fit, newdata=data.frame(x1=x1new),
interval="prediction")
conf <- predict(fit, newdata=data.frame(x1=x1new),
interval="confidence")
plot(x1new, pred[ ,"fit"], type="l", ylim=c(0.1,2.4),
xlab="x1", ylab="Prediction")
lines(x1new, conf[ ,"lwr"], col="green", lty=2)
lines(x1new, conf[ ,"upr"], col="green", lty=2)
lines(x1new, pred[ ,"lwr"], col="red", lty=2)
lines(x1new, pred[ ,"upr"], col="red", lty=2)
legend("topleft", c("Prediction","Confidence band","Prediction band"),
lty=c(1,2,2), col=c(1,3,2), cex=0.7)
x1new <- seq(0,1,by=0.01)
pred <- predict(fit, newdata=data.frame(x1=x1new),
interval="prediction")
conf <- predict(fit, newdata=data.frame(x1=x1new),
interval="confidence")
plot(x1new, pred[ ,"fit"], type="l", ylim=c(0.1,2.4),
xlab="x1", ylab="Prediction")
lines(x1new, conf[ ,"lwr"], col="green", lty=2)
lines(x1new, conf[ ,"upr"], col="green", lty=2)
lines(x1new, pred[ ,"lwr"], col="red", lty=2)
lines(x1new, pred[ ,"upr"], col="red", lty=2)
legend("topleft", c("Prediction","Confidence band","Prediction band"),
lty=c(1,2,2), col=c(1,3,2), cex=0.7)
x1new <- seq(0,1,by=0.01)
pred <- predict(fit, newdata=data.frame(x1=x1new),
interval="prediction")
conf <- predict(fit, newdata=data.frame(x1=x1new),
interval="confidence")
plot(x1new, pred[ ,"fit"], type="l", ylim=c(0.1,2.4),
xlab="x1", ylab="Prediction")
lines(x1new, conf[ ,"lwr"], col="green", lty=2)
lines(x1new, conf[ ,"upr"], col="green", lty=2)
lines(x1new, pred[ ,"lwr"], col="red", lty=2)
lines(x1new, pred[ ,"upr"], col="red", lty=2)
legend("topleft", c("Prediction","Confidence band","Prediction band"),
lty=c(1,2,2), col=c(1,3,2), cex=0.7)
par(mfrow=c(1,1))
x1new <- seq(0,1,by=0.01)
pred <- predict(fit, newdata=data.frame(x1=x1new),
interval="prediction")
conf <- predict(fit, newdata=data.frame(x1=x1new),
interval="confidence")
plot(x1new, pred[ ,"fit"], type="l", ylim=c(0.1,2.4),
xlab="x1", ylab="Prediction")
lines(x1new, conf[ ,"lwr"], col="green", lty=2)
lines(x1new, conf[ ,"upr"], col="green", lty=2)
lines(x1new, pred[ ,"lwr"], col="red", lty=2)
lines(x1new, pred[ ,"upr"], col="red", lty=2)
legend("topleft", c("Prediction","Confidence band","Prediction band"),
lty=c(1,2,2), col=c(1,3,2), cex=0.7)
conf
